<script>
  // Mobile menu
  const btn = document.querySelector(".menu-btn");
  const links = document.querySelector("#navLinks");

  function closeMenu() {
    btn.setAttribute("aria-expanded", "false");
    links.classList.remove("open");
  }

  btn.addEventListener("click", () => {
    const isOpen = btn.getAttribute("aria-expanded") === "true";
    btn.setAttribute("aria-expanded", String(!isOpen));
    links.classList.toggle("open");
  });

  links.querySelectorAll("a").forEach(a => a.addEventListener("click", closeMenu));

  window.addEventListener("resize", () => {
    if (window.innerWidth > 980) closeMenu();
  });

  // Scroll progress bar
  const fill = document.querySelector(".scrollbar-fill");

  function updateScroll() {
    const h = document.documentElement;
    const max = h.scrollHeight - h.clientHeight;
    const p = max > 0 ? (h.scrollTop / max) : 0;
    fill.style.transform = "scaleX(" + p.toFixed(4) + ")";
  }

  document.addEventListener("scroll", updateScroll, { passive: true });
  updateScroll();

  // Reveal on scroll
  const items = document.querySelectorAll(".reveal");
  const io = new IntersectionObserver((entries) => {
    entries.forEach(e => {
      if (e.isIntersecting) {
        e.target.classList.add("in");
        io.unobserve(e.target);
      }
    });
  }, { threshold: 0.12 });

  items.forEach(el => io.observe(el));

  // Tilt effect (subtle)
  const tiltCards = document.querySelectorAll(".tilt");

  tiltCards.forEach(card => {
    let raf = 0;

    function onMove(ev) {
      const r = card.getBoundingClientRect();
      const x = (ev.clientX - r.left) / r.width;
      const y = (ev.clientY - r.top) / r.height;

      const rx = (0.5 - y) * 6;
      const ry = (x - 0.5) * 7;

      cancelAnimationFrame(raf);
      raf = requestAnimationFrame(() => {
        card.style.transform =
          "translateY(-2px) rotateX(" + rx.toFixed(2) + "deg) rotateY(" + ry.toFixed(2) + "deg)";
      });
    }

    function onLeave() {
      card.style.transform = "";
    }

    card.addEventListener("mousemove", onMove);
    card.addEventListener("mouseleave", onLeave);
  });
</script>
</body>
</html>
